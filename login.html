<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Flow - Login e Cadastro" />
    <meta name="keywords" content="login, cadastro, autenticação, flow" />
    <meta name="author" content="Aluno UTFPR" />

    <title>Login - Flow</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="assets/images/favicon.svg" />

    <!-- Bootstrap 5 CSS Framework (RA1 - ID 01) -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Font Awesome Icons -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />

    <!-- Animate.css for animations (RA1 - ID 05) -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
      rel="stylesheet"
    />

    <!-- Google Fonts for responsive typography (RA1 - ID 09) -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Custom CSS with Design System (RA1 - ID 07, ID 08) -->
    <link href="assets/css/style.css" rel="stylesheet" />
  </head>
  <body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top main-navbar">
      <div class="container">
        <a class="navbar-brand brand-logo" href="index.html">
          <i class="fas fa-tasks brand-icon"></i>
          <span class="brand-text">Flow</span>
        </a>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">
                <i class="fas fa-home nav-icon"></i>
                Início
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="tasks.html">
                <i class="fas fa-list-check nav-icon"></i>
                Tarefas
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="login.html">
                <i class="fas fa-user nav-icon"></i>
                Login
              </a>
            </li>
          </ul>

          <div class="navbar-nav">
            <button class="btn btn-primary-custom" id="toggle-form-btn">
              <i class="fas fa-user-plus button-icon"></i>
              Criar Conta
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <div class="auth-section">
        <div class="container">
          <div class="row min-vh-100 align-items-center">
            <!-- Left Side - Branding -->
            <div class="col-lg-6 d-none d-lg-block">
              <div
                class="auth-branding text-center animate__animated animate__fadeInLeft"
              >
                <div class="auth-brand-icon">
                  <i class="fas fa-tasks"></i>
                </div>
                <h2 class="auth-brand-title">Flow</h2>
                <p class="auth-brand-description">
                  Organize suas tarefas acadêmicas com simplicidade e eficiência
                </p>

                <div class="auth-features">
                  <div class="auth-feature-item">
                    <i class="fas fa-check-circle auth-feature-icon"></i>
                    <span>Interface moderna e intuitiva</span>
                  </div>
                  <div class="auth-feature-item">
                    <i class="fas fa-mobile-alt auth-feature-icon"></i>
                    <span>Acesso em qualquer dispositivo</span>
                  </div>
                  <div class="auth-feature-item">
                    <i class="fas fa-save auth-feature-icon"></i>
                    <span>Dados sincronizados e seguros</span>
                  </div>
                  <div class="auth-feature-item">
                    <i class="fas fa-graduation-cap auth-feature-icon"></i>
                    <span>Focado em necessidades acadêmicas</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Right Side - Forms -->
            <div class="col-lg-6">
              <div
                class="auth-forms-container animate__animated animate__fadeInRight"
              >
                <!-- Login Form (Formulário com validação - Escopo Mínimo) -->
                <div class="auth-form-wrapper" id="login-form-wrapper">
                  <div class="card auth-card">
                    <div class="card-body">
                      <div class="text-center mb-4">
                        <h3 class="auth-form-title">Bem-vindo de volta!</h3>
                        <p class="auth-form-description">
                          Entre na sua conta para continuar
                        </p>
                      </div>

                      <!-- Form with validation (RA2 - ID 12, ID 13) -->
                      <form id="login-form" class="auth-form">
                        <div class="form-group">
                          <label
                            for="login-email"
                            class="form-label required-field"
                            >E-mail</label
                          >
                          <div class="input-group">
                            <span class="input-group-text">
                              <i class="fas fa-envelope"></i>
                            </span>
                            <input
                              type="email"
                              class="form-control"
                              id="login-email"
                              name="email"
                              placeholder="seu@email.com"
                              required
                              autocomplete="email"
                            />
                            <div class="form-feedback"></div>
                          </div>
                        </div>

                        <div class="form-group">
                          <label
                            for="login-password"
                            class="form-label required-field"
                            >Senha</label
                          >
                          <div class="input-group">
                            <span class="input-group-text">
                              <i class="fas fa-lock"></i>
                            </span>
                            <input
                              type="password"
                              class="form-control"
                              id="login-password"
                              name="password"
                              placeholder="Sua senha"
                              required
                              minlength="6"
                              autocomplete="current-password"
                            />
                            <button
                              class="btn btn-outline-secondary password-toggle"
                              type="button"
                            >
                              <i class="fas fa-eye"></i>
                            </button>
                          </div>
                          <div class="form-feedback"></div>
                        </div>

                        <div class="form-group">
                          <!-- Checkbox (RA2 - ID 14) -->
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              id="remember-me"
                              name="remember"
                            />
                            <label class="form-check-label" for="remember-me">
                              Lembrar de mim
                            </label>
                          </div>
                        </div>

                        <button
                          type="submit"
                          class="btn btn-primary-custom w-100 mb-3"
                        >
                          <i class="fas fa-sign-in-alt button-icon"></i>
                          Entrar
                        </button>

                        <div class="text-center">
                          <p class="auth-switch-text">
                            Não tem uma conta?
                            <a
                              href="#"
                              class="auth-switch-link"
                              id="show-register"
                              >Criar conta</a
                            >
                          </p>
                        </div>

                        <!-- Demo credentials info -->
                        <div class="alert alert-info auth-demo-info">
                          <h6>
                            <i class="fas fa-info-circle"></i> Credenciais de
                            Teste:
                          </h6>
                          <small>
                            <strong>Email:</strong> demo@flow.com<br />
                            <strong>Senha:</strong> demo123
                          </small>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>

                <!-- Register Form (Formulário com validação - Escopo Mínimo) -->
                <div
                  class="auth-form-wrapper d-none"
                  id="register-form-wrapper"
                >
                  <div class="card auth-card">
                    <div class="card-body">
                      <div class="text-center mb-4">
                        <h3 class="auth-form-title">Criar Conta</h3>
                        <p class="auth-form-description">
                          Junte-se ao Flow e organize suas tarefas
                        </p>
                      </div>

                      <!-- Form with validation (RA2 - ID 12, ID 13) -->
                      <form id="register-form" class="auth-form">
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group">
                              <label
                                for="register-name"
                                class="form-label required-field"
                                >Nome Completo</label
                              >
                              <input
                                type="text"
                                class="form-control"
                                id="register-name"
                                name="name"
                                placeholder="Seu nome completo"
                                required
                                minlength="2"
                                maxlength="50"
                              />
                              <div class="form-feedback"></div>
                            </div>
                          </div>
                          <div class="col-md-6" />
                        </div>

                        <div class="form-group">
                          <label
                            for="register-email"
                            class="form-label required-field"
                            >E-mail</label
                          >
                          <div class="input-group">
                            <span class="input-group-text">
                              <i class="fas fa-envelope"></i>
                            </span>
                            <input
                              type="email"
                              class="form-control"
                              id="register-email"
                              name="email"
                              placeholder="seu@email.com"
                              required
                              autocomplete="email"
                            />
                          </div>
                          <div class="form-feedback"></div>
                        </div>

                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group">
                              <label
                                for="register-password"
                                class="form-label required-field"
                                >Senha</label
                              >
                              <div class="input-group">
                                <span class="input-group-text">
                                  <i class="fas fa-lock"></i>
                                </span>
                                <input
                                  type="password"
                                  class="form-control"
                                  id="register-password"
                                  name="password"
                                  placeholder="Sua senha"
                                  required
                                  minlength="6"
                                  autocomplete="new-password"
                                />
                                <button
                                  class="btn btn-outline-secondary password-toggle"
                                  type="button"
                                >
                                  <i class="fas fa-eye"></i>
                                </button>
                              </div>
                              <div class="form-feedback"></div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group">
                              <label
                                for="register-confirm-password"
                                class="form-label required-field"
                                >Confirmar Senha</label
                              >
                              <input
                                type="password"
                                class="form-control"
                                id="register-confirm-password"
                                name="confirmPassword"
                                placeholder="Confirme sua senha"
                                required
                                minlength="6"
                              />
                              <div class="form-feedback"></div>
                            </div>
                          </div>
                        </div>

                        <div class="form-group">
                          <label for="register-institution" class="form-label"
                            >Instituição de Ensino</label
                          >
                          <!-- Select element (RA2 - ID 14) -->
                          <select
                            class="form-select"
                            id="register-institution"
                            name="institution"
                          >
                            <option value="">Selecione sua instituição</option>
                            <option value="UTFPR">
                              UTFPR - Universidade Tecnológica Federal do Paraná
                            </option>
                            <option value="USP">
                              USP - Universidade de São Paulo
                            </option>
                            <option value="UFPR">
                              UFPR - Universidade Federal do Paraná
                            </option>
                            <option value="UFSC">
                              UFSC - Universidade Federal de Santa Catarina
                            </option>
                            <option value="UFRGS">
                              UFRGS - Universidade Federal do Rio Grande do Sul
                            </option>
                            <option value="Other">Outra</option>
                          </select>
                        </div>

                        <div class="form-group">
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              id="terms-accept"
                              name="terms"
                              required
                            />
                            <label class="form-check-label" for="terms-accept">
                              Aceito os
                              <a href="#" class="auth-link">termos de uso</a> e
                              <a href="#" class="auth-link"
                                >política de privacidade</a
                              >
                            </label>
                          </div>
                          <div class="form-feedback"></div>
                        </div>

                        <div class="form-group">
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              id="newsletter-subscribe"
                              name="newsletter"
                            />
                            <label
                              class="form-check-label"
                              for="newsletter-subscribe"
                            >
                              Quero receber dicas de produtividade por email
                            </label>
                          </div>
                        </div>

                        <button
                          type="submit"
                          class="btn btn-primary-custom w-100 mb-3"
                        >
                          <i class="fas fa-user-plus button-icon"></i>
                          Criar Conta
                        </button>

                        <div class="text-center">
                          <p class="auth-switch-text">
                            Já tem uma conta?
                            <a href="#" class="auth-switch-link" id="show-login"
                              >Fazer login</a
                            >
                          </p>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer-section">
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <div class="footer-brand">
              <h5 class="footer-title">
                <i class="fas fa-tasks footer-icon"></i>
                Flow
              </h5>
              <p class="footer-description">
                Gerenciador de tarefas acadêmico inspirado no Todoist. Projeto
                desenvolvido para fins educacionais.
              </p>
            </div>
          </div>
          <div class="col-md-3">
            <h6 class="footer-subtitle">Páginas</h6>
            <ul class="footer-list">
              <li><a href="index.html" class="footer-link">Início</a></li>
              <li><a href="tasks.html" class="footer-link">Tarefas</a></li>
              <li><a href="login.html" class="footer-link">Login</a></li>
            </ul>
          </div>
          <div class="col-md-3">
            <h6 class="footer-subtitle">Projeto</h6>
            <ul class="footer-list">
              <li>UTFPR - Acadêmico</li>
              <li>Inspirado no Todoist</li>
              <li>2025</li>
            </ul>
          </div>
        </div>
        <hr class="footer-divider" />
        <div class="row align-items-center">
          <div class="col-md-6">
            <p class="footer-copyright">
              © 2025 Flow. Projeto acadêmico - Todos os direitos reservados.
            </p>
          </div>
          <div class="col-md-6 text-end">
            <a href="https://todoist.com" target="_blank" class="footer-link">
              <i class="fas fa-external-link-alt"></i>
              Inspiração: Todoist
            </a>
          </div>
        </div>
      </div>
    </footer>

    <!-- JavaScript Dependencies -->
    <!-- jQuery (RA4 - ID 23) -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- jQuery Mask Plugin (RA4 - ID 24) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>

    <!-- Auth page specific JavaScript -->
    <script>
      $(document).ready(function () {
        console.log("Flow Login Page Loaded");

        // Initialize phone mask (RA4 - ID 24)
        $(".phone-mask").mask("(00) 00000-0000", {
          placeholder: "(11) 99999-9999",
        });

        // Form switching
        $("#show-register").on("click", function (e) {
          e.preventDefault();
          switchToRegister();
        });

        $("#show-login").on("click", function (e) {
          e.preventDefault();
          switchToLogin();
        });

        $("#toggle-form-btn").on("click", function () {
          if ($("#login-form-wrapper").hasClass("d-none")) {
            switchToLogin();
          } else {
            switchToRegister();
          }
        });

        // Password visibility toggle
        $(".password-toggle").on("click", function () {
          const input = $(this).siblings("input");
          const icon = $(this).find("i");

          if (input.attr("type") === "password") {
            input.attr("type", "text");
            icon.removeClass("fa-eye").addClass("fa-eye-slash");
          } else {
            input.attr("type", "password");
            icon.removeClass("fa-eye-slash").addClass("fa-eye");
          }
        });

        // Real-time validation (RA2 - ID 12, ID 13)
        $("input, select").on("input blur", function () {
          validateField(this);
        });

        // Form submissions
        $("#login-form").on("submit", handleLoginSubmit);
        $("#register-form").on("submit", handleRegisterSubmit);

        // Custom validation for password confirmation
        $("#register-confirm-password").on("input", function () {
          const password = $("#register-password").val();
          const confirmPassword = $(this).val();

          if (confirmPassword && password !== confirmPassword) {
            showFieldError(this, "As senhas não coincidem");
          } else {
            clearFieldError(this);
            if (confirmPassword) {
              $(this).addClass("is-valid");
            }
          }
        });
      });

      function switchToRegister() {
        $("#login-form-wrapper").addClass("d-none animate__fadeOutLeft");
        $("#register-form-wrapper")
          .removeClass("d-none")
          .addClass("animate__fadeInRight");
        $("#toggle-form-btn").html(
          '<i class="fas fa-sign-in-alt button-icon"></i>Fazer Login',
        );

        // Clear login form
        $("#login-form")[0].reset();
        clearAllErrors("#login-form");
      }

      function switchToLogin() {
        $("#register-form-wrapper").addClass("d-none animate__fadeOutRight");
        $("#login-form-wrapper")
          .removeClass("d-none")
          .addClass("animate__fadeInLeft");
        $("#toggle-form-btn").html(
          '<i class="fas fa-user-plus button-icon"></i>Criar Conta',
        );

        // Clear register form
        $("#register-form")[0].reset();
        clearAllErrors("#register-form");
      }

      // Validation functions using regex (RA2 - ID 13)
      function validateField(field) {
        const $field = $(field);
        const value = $field.val().trim();
        const type = $field.attr("type");
        const name = $field.attr("name");
        const required = $field.prop("required");

        // Email validation with regex
        const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

        // Phone validation with regex (Brazilian format)
        const phoneRegex = /^\(\d{2}\)\s\d{4,5}-\d{4}$/;

        if (required && !value) {
          showFieldError(field, "Este campo é obrigatório");
          return false;
        }

        if (value) {
          if (type === "email" && !emailRegex.test(value)) {
            showFieldError(field, "Por favor, insira um email válido");
            return false;
          }

          if (name === "phone" && value && !phoneRegex.test(value)) {
            showFieldError(field, "Formato: (11) 99999-9999");
            return false;
          }

          if (type === "password" && value.length < 6) {
            showFieldError(field, "A senha deve ter pelo menos 6 caracteres");
            return false;
          }

          if (name === "name" && value.length < 2) {
            showFieldError(field, "Nome deve ter pelo menos 2 caracteres");
            return false;
          }
        }

        clearFieldError(field);
        if (value) {
          $field.addClass("is-valid");
        }
        return true;
      }

      function showFieldError(field, message) {
        const $field = $(field);
        clearFieldError(field);

        $field.addClass("is-invalid");

        let $feedback = $field.siblings(".form-feedback");
        if ($feedback.length === 0) {
          $feedback = $field.closest(".input-group").siblings(".form-feedback");
        }

        $feedback.text(message).addClass("invalid-feedback").show();
      }

      function clearFieldError(field) {
        const $field = $(field);
        $field.removeClass("is-invalid is-valid");

        let $feedback = $field.siblings(".form-feedback");
        if ($feedback.length === 0) {
          $feedback = $field.closest(".input-group").siblings(".form-feedback");
        }

        $feedback.text("").removeClass("invalid-feedback").hide();
      }

      function clearAllErrors(formSelector) {
        $(
          `${formSelector} .form-control, ${formSelector} .form-select`,
        ).removeClass("is-invalid is-valid");
        $(`${formSelector} .form-feedback`)
          .text("")
          .removeClass("invalid-feedback")
          .hide();
      }

      function validateForm(form) {
        const $form = $(form);
        let isValid = true;

        $form.find("input[required], select[required]").each(function () {
          if (!validateField(this)) {
            isValid = false;
          }
        });

        // Additional validation for password confirmation
        if (form.id === "register-form") {
          const password = $("#register-password").val();
          const confirmPassword = $("#register-confirm-password").val();

          if (password !== confirmPassword) {
            showFieldError(
              $("#register-confirm-password")[0],
              "As senhas não coincidem",
            );
            isValid = false;
          }
        }

        return isValid;
      }

      function handleLoginSubmit(e) {
        e.preventDefault();

        if (!validateForm(this)) {
          showNotification(
            "Por favor, corrija os erros no formulário",
            "warning",
          );
          return;
        }

        const formData = new FormData(this);
        const loginData = {
          email: formData.get("email"),
          password: formData.get("password"),
          remember: formData.get("remember") === "on",
        };

        // Show loading state
        const $submitBtn = $(this).find('button[type="submit"]');
        const originalText = $submitBtn.html();
        $submitBtn
          .html('<i class="fas fa-spinner fa-spin button-icon"></i>Entrando...')
          .prop("disabled", true);

        // Simulate login process (Persistência com Web Storage - RA2 - ID 15)
        setTimeout(() => {
          try {
            // Demo credentials check
            if (
              loginData.email === "demo@flow.com" &&
              loginData.password === "demo123"
            ) {
              // Save user session to localStorage
              const userData = {
                id: "demo-user",
                name: "Usuário Demo",
                email: loginData.email,
                loginTime: new Date().toISOString(),
              };

              localStorage.setItem("flow_user", JSON.stringify(userData));

              if (loginData.remember) {
                localStorage.setItem("flow_remember", "true");
              }

              showNotification("Login realizado com sucesso!", "success");

              // Redirect to tasks page
              setTimeout(() => {
                window.location.href = "tasks.html";
              }, 1500);
            } else {
              throw new Error("Credenciais inválidas");
            }
          } catch (error) {
            showNotification("Email ou senha incorretos", "danger");
            $submitBtn.html(originalText).prop("disabled", false);
          }
        }, 1500);
      }

      function handleRegisterSubmit(e) {
        e.preventDefault();

        if (!validateForm(this)) {
          showNotification(
            "Por favor, corrija os erros no formulário",
            "warning",
          );
          return;
        }

        const formData = new FormData(this);
        const registerData = {
          name: formData.get("name"),
          email: formData.get("email"),
          phone: formData.get("phone"),
          password: formData.get("password"),
          institution: formData.get("institution"),
          studyArea: formData.get("studyArea"),
          terms: formData.get("terms") === "on",
          newsletter: formData.get("newsletter") === "on",
        };

        // Show loading state
        const $submitBtn = $(this).find('button[type="submit"]');
        const originalText = $submitBtn.html();
        $submitBtn
          .html(
            '<i class="fas fa-spinner fa-spin button-icon"></i>Criando conta...',
          )
          .prop("disabled", true);

        // Simulate registration process (Persistência com Web Storage - RA2 - ID 15)
        setTimeout(() => {
          try {
            // Save user data to localStorage
            const userData = {
              id: "user-" + Date.now(),
              name: registerData.name,
              email: registerData.email,
              phone: registerData.phone,
              institution: registerData.institution,
              studyArea: registerData.studyArea,
              newsletter: registerData.newsletter,
              registeredAt: new Date().toISOString(),
            };

            // Save to local storage
            let users = JSON.parse(localStorage.getItem("flow_users") || "[]");

            // Check if email already exists
            if (users.find((user) => user.email === registerData.email)) {
              throw new Error("Email já cadastrado");
            }

            users.push(userData);
            localStorage.setItem("flow_users", JSON.stringify(users));
            localStorage.setItem("flow_user", JSON.stringify(userData));

            showNotification("Conta criada com sucesso!", "success");

            // Redirect to tasks page
            setTimeout(() => {
              window.location.href = "tasks.html";
            }, 1500);
          } catch (error) {
            showNotification(error.message || "Erro ao criar conta", "danger");
            $submitBtn.html(originalText).prop("disabled", false);
          }
        }, 2000);
      }

      // Notification function
      function showNotification(message, type = "info") {
        const notification = $(`
        <div class="alert alert-${type} alert-dismissible fade show position-fixed animate__animated animate__fadeInRight"
             style="top: 100px; right: 20px; z-index: 9999; min-width: 300px; max-width: 400px;">
          <div class="d-flex justify-content-between align-items-center">
            <span>${message}</span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        </div>
      `);

        $("body").append(notification);

        setTimeout(() => {
          notification.addClass("animate__fadeOutRight");
          setTimeout(() => notification.remove(), 500);
        }, 5000);
      }
    </script>
  </body>
</html>
