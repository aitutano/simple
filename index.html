<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="TaskFlow - Gerenciador de tarefas inspirado no Todoist"
    />
    <meta
      name="keywords"
      content="tarefas, produtividade, organização, todoist"
    />
    <meta name="author" content="Aluno UTFPR" />

    <title>TaskFlow - Organize suas tarefas com simplicidade</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico" />

    <!-- CSS Dependencies -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
      rel="stylesheet"
    />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Custom CSS -->
    <link href="assets/css/style.css" rel="stylesheet" />
    <link href="assets/css/responsive.css" rel="stylesheet" />
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg main-navbar">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="index.html">
          <i class="fas fa-tasks me-2"></i>
          <span>Flow</span>
        </a>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link active" href="index.html">
                <i class="fas fa-home me-1"></i>
                Dashboard
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="pages/tasks.html">
                <i class="fas fa-list-check me-1"></i>
                Tarefas
              </a>
            </li>
          </ul>

          <div class="navbar-nav">
            <button
              class="btn btn-primary-custom me-2"
              data-bs-toggle="modal"
              data-bs-target="#newTaskModal"
            >
              <i class="fas fa-plus me-1"></i>
              Nova Tarefa
            </button>
            <div class="dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                data-bs-toggle="dropdown"
              >
                <i class="fas fa-user-circle fs-4"></i>
              </a>
              <ul class="dropdown-menu">
                <li>
                  <a class="dropdown-item" href="pages/profile.html">Perfil</a>
                </li>
                <li>
                  <a class="dropdown-item" href="#" onclick="app.toggleTheme()"
                    >Alterar Tema</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item" href="#" onclick="app.logout()"
                    >Sair</a
                  >
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <!-- Hero Section -->
    <section
      class="hero-section py-5"
      style="
        background: linear-gradient(
          135deg,
          var(--accent-bg) 0%,
          var(--secondary-bg) 100%
        );
      "
    >
      <div class="container">
        <div class="row align-items-center">
          <div class="col-lg-6">
            <div class="hero-content animate__animated animate__fadeInLeft">
              <h1 class="display-4 fw-bold mb-4">
                Organize sua vida com
                <span style="color: var(--primary-red)">simplicidade</span>
              </h1>
              <p class="lead text-muted mb-4">
                Flow traz clareza e organização para suas tarefas diárias.
                Inspirado no Todoist, construído para você.
              </p>
              <div class="hero-stats mb-4">
                <div class="row text-center">
                  <div class="col-4">
                    <div class="stat-card">
                      <h3 class="fw-bold mb-0" id="total-tasks">0</h3>
                      <small class="text-muted">Tarefas</small>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="stat-card">
                      <h3 class="fw-bold mb-0" id="completed-tasks">0</h3>
                      <small class="text-muted">Concluídas</small>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="stat-card">
                      <h3 class="fw-bold mb-0" id="pending-tasks">0</h3>
                      <small class="text-muted">Pendentes</small>
                    </div>
                  </div>
                </div>
              </div>
              <div class="hero-actions button-stack">
                <button
                  class="btn btn-primary-custom btn-lg me-3"
                  data-bs-toggle="modal"
                  data-bs-target="#newTaskModal"
                >
                  <i class="fas fa-plus me-2"></i>
                  Criar primeira tarefa
                </button>
                <a
                  href="pages/tasks.html"
                  class="btn btn-outline-custom btn-lg"
                >
                  Ver todas as tarefas
                </a>
              </div>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="hero-image animate__animated animate__fadeInRight">
              <div
                class="task-preview-card p-4"
                style="
                  background: var(--secondary-bg);
                  border-radius: var(--radius-xl);
                  box-shadow: var(--shadow-lg);
                "
              >
                <h5 class="mb-3">
                  <i
                    class="fas fa-calendar-day me-2"
                    style="color: var(--primary-red)"
                  ></i>
                  Hoje
                </h5>
                <div
                  class="preview-task mb-3 p-3"
                  style="
                    border-left: 3px solid var(--priority-high);
                    background: rgba(231, 76, 60, 0.05);
                  "
                >
                  <div class="d-flex align-items-center">
                    <i class="far fa-circle me-2"></i>
                    <span>Finalizar projeto da faculdade</span>
                    <span class="ms-auto badge bg-danger">Alta</span>
                  </div>
                </div>
                <div
                  class="preview-task mb-3 p-3"
                  style="
                    border-left: 3px solid var(--priority-medium);
                    background: rgba(243, 156, 18, 0.05);
                  "
                >
                  <div class="d-flex align-items-center">
                    <i class="far fa-circle me-2"></i>
                    <span>Fazer compras no supermercado</span>
                    <span class="ms-auto badge bg-warning">Média</span>
                  </div>
                </div>
                <div
                  class="preview-task p-3"
                  style="
                    border-left: 3px solid var(--priority-low);
                    background: rgba(39, 174, 96, 0.05);
                  "
                >
                  <div class="d-flex align-items-center">
                    <i class="fas fa-check-circle me-2 text-success"></i>
                    <span class="text-decoration-line-through text-muted"
                      >Ler 30 páginas do livro</span
                    >
                    <span class="ms-auto badge bg-success">Baixa</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Quick Actions -->
    <section
      class="quick-actions py-4"
      style="
        background: var(--secondary-bg);
        border-bottom: 1px solid var(--border-color);
      "
    >
      <div class="container">
        <div class="row">
          <div class="col-md-8">
            <div class="quick-add-task">
              <form id="quick-task-form" class="d-flex gap-2">
                <div class="flex-grow-1">
                  <input
                    type="text"
                    class="form-control"
                    placeholder="Adicionar tarefa rápida... (Ex: Comprar leite às 18h #casa)"
                    name="title"
                    data-validation="required"
                  />
                </div>
                <button type="submit" class="btn btn-primary-custom">
                  <i class="fas fa-plus"></i>
                </button>
              </form>
            </div>
          </div>
          <div class="col-md-4">
            <div class="d-flex gap-2 justify-content-end">
              <select
                class="form-select form-select-sm"
                data-filter="status"
                style="width: auto"
              >
                <option value="all">Todos os status</option>
                <option value="pending">Pendentes</option>
                <option value="in_progress">Em andamento</option>
                <option value="completed">Concluídas</option>
              </select>
              <select
                class="form-select form-select-sm"
                data-filter="priority"
                style="width: auto"
              >
                <option value="all">Todas as prioridades</option>
                <option value="high">Alta</option>
                <option value="medium">Média</option>
                <option value="low">Baixa</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Main Dashboard Content -->
    <main class="dashboard-main py-5">
      <div class="container">
        <div class="dashboard-grid">
          <!-- Today's Tasks -->
          <div class="main-content">
            <div
              class="section-header d-flex justify-content-between align-items-center mb-4"
            >
              <h2>
                <i
                  class="fas fa-calendar-day me-2"
                  style="color: var(--primary-red)"
                ></i>
                Hoje
              </h2>
              <div class="section-actions">
                <button
                  class="btn btn-sm btn-outline-primary"
                  onclick="taskManager.loadTasks()"
                >
                  <i class="fas fa-sync-alt me-1"></i>
                  Atualizar
                </button>
              </div>
            </div>

            <!-- Tasks Container using Web Components -->
            <div id="tasks-container" class="tasks-container">
              <div class="loading-state text-center py-5">
                <div class="loading-spinner"></div>
                <p class="text-muted mt-3">Carregando tarefas...</p>
              </div>
            </div>
          </div>

          <!-- Sidebar -->
          <div class="sidebar-content">
            <!-- Progress Card -->
            <div
              class="card mb-4"
              style="
                border: 1px solid var(--border-color);
                border-radius: var(--radius-lg);
              "
            >
              <div class="card-body">
                <h5 class="card-title">
                  <i
                    class="fas fa-chart-line me-2"
                    style="color: var(--success-green)"
                  ></i>
                  Progresso de Hoje
                </h5>
                <div class="progress mb-3" style="height: 10px">
                  <div
                    class="progress-bar"
                    role="progressbar"
                    style="width: 0%; background-color: var(--success-green)"
                    id="daily-progress"
                  ></div>
                </div>
                <div class="progress-stats">
                  <div class="d-flex justify-content-between">
                    <small class="text-muted">Concluídas</small>
                    <small class="fw-bold" id="progress-text">0 de 0</small>
                  </div>
                </div>
              </div>
            </div>

            <!-- Recent Activity -->
            <div
              class="card mb-4"
              style="
                border: 1px solid var(--border-color);
                border-radius: var(--radius-lg);
              "
            >
              <div class="card-body">
                <div
                  class="d-flex justify-content-between align-items-center mb-3"
                >
                  <h5 class="card-title mb-0">
                    <i
                      class="fas fa-clock me-2"
                      style="color: var(--info-blue)"
                    ></i>
                    Atividade Recente
                  </h5>
                  <a
                    href="pages/tasks.html"
                    class="btn btn-sm btn-outline-primary"
                    >Ver todas</a
                  >
                </div>
                <div id="recent-activity">
                  <div class="loading-state">
                    <div
                      class="skeleton"
                      style="
                        height: 20px;
                        border-radius: 4px;
                        margin-bottom: 8px;
                      "
                    ></div>
                    <div
                      class="skeleton"
                      style="
                        height: 20px;
                        border-radius: 4px;
                        margin-bottom: 8px;
                      "
                    ></div>
                    <div
                      class="skeleton"
                      style="height: 20px; border-radius: 4px"
                    ></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Quick Stats -->
            <div
              class="card"
              style="
                border: 1px solid var(--border-color);
                border-radius: var(--radius-lg);
              "
            >
              <div class="card-body">
                <h5 class="card-title">
                  <i
                    class="fas fa-chart-pie me-2"
                    style="color: var(--warning-orange)"
                  ></i>
                  Estatísticas
                </h5>
                <div class="stats-grid">
                  <div class="stat-item mb-3">
                    <div class="d-flex justify-content-between">
                      <span class="text-muted">Esta semana</span>
                      <span class="fw-bold" id="week-completed">0</span>
                    </div>
                  </div>
                  <div class="stat-item mb-3">
                    <div class="d-flex justify-content-between">
                      <span class="text-muted">Este mês</span>
                      <span class="fw-bold" id="month-completed">0</span>
                    </div>
                  </div>
                  <div class="stat-item">
                    <div class="d-flex justify-content-between">
                      <span class="text-muted">Produtividade</span>
                      <span class="fw-bold text-success" id="productivity-score"
                        >0%</span
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- New Task Modal -->
    <div class="modal fade" id="newTaskModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              <i class="fas fa-plus me-2"></i>
              Nova Tarefa
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="task-form" data-validate>
              <div class="row">
                <div class="col-md-8">
                  <div class="form-group">
                    <label for="task-title" class="form-label"
                      >Título da Tarefa *</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="task-title"
                      name="title"
                      placeholder="Ex: Finalizar relatório mensal"
                      data-validation="required|maxLength:100"
                    />
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label for="task-priority" class="form-label"
                      >Prioridade</label
                    >
                    <select
                      class="form-select"
                      id="task-priority"
                      name="priority"
                    >
                      <option value="low">Baixa</option>
                      <option value="medium" selected>Média</option>
                      <option value="high">Alta</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label for="task-description" class="form-label"
                  >Descrição</label
                >
                <textarea
                  class="form-control"
                  id="task-description"
                  name="description"
                  rows="3"
                  placeholder="Descreva os detalhes da tarefa..."
                  data-validation="maxLength:500"
                ></textarea>
              </div>

              <div class="form-group">
                <label for="task-due-date" class="form-label"
                  >Data de Vencimento</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="task-due-date"
                  name="dueDate"
                  data-validation="date"
                />
              </div>

              <div class="form-group">
                <label for="task-tags" class="form-label">Tags</label>
                <input
                  type="text"
                  class="form-control"
                  id="task-tags"
                  name="tags"
                  placeholder="trabalho, urgente, pessoal (separadas por vírgula)"
                />
                <small class="form-text text-muted"
                  >Separe as tags por vírgula</small
                >
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-outline-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="submit"
              form="task-form"
              class="btn btn-primary-custom"
            >
              <i class="fas fa-save me-1"></i>
              Salvar Tarefa
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer
      class="footer py-4 mt-5"
      style="
        background: var(--accent-bg);
        border-top: 1px solid var(--border-color);
      "
    >
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <div class="footer-brand mb-3">
              <h5>
                <i
                  class="fas fa-tasks me-2"
                  style="color: var(--primary-red)"
                ></i>
                Flow
              </h5>
              <p class="text-muted">
                Organize suas tarefas com simplicidade e eficiência. Inspirado
                no Todoist, desenvolvido para fins acadêmicos.
              </p>
            </div>
          </div>
          <div class="col-md-3">
            <h6 class="fw-bold mb-3">Links Úteis</h6>
            <ul class="list-unstyled">
              <li>
                <a
                  href="pages/tasks.html"
                  class="text-muted text-decoration-none"
                  >Tarefas</a
                >
              </li>
              <li>
                <a href="landing.html" class="text-muted text-decoration-none"
                  >Página Inicial</a
                >
              </li>
              <li>
                <a href="#" class="text-muted text-decoration-none">Ajuda</a>
              </li>
            </ul>
          </div>
          <div class="col-md-3">
            <h6 class="fw-bold mb-3">Tecnologias</h6>
            <ul class="list-unstyled">
              <li class="text-muted">Bootstrap 5</li>
              <li class="text-muted">Lit Web Components</li>
              <li class="text-muted">jQuery</li>
              <li class="text-muted">JSON Server</li>
            </ul>
          </div>
        </div>
        <hr style="border-color: var(--border-color)" />
        <div class="row align-items-center">
          <div class="col-md-6">
            <p class="text-muted mb-0">
              &copy; 2025 Flow. Projeto acadêmico - UTFPR.
            </p>
          </div>
          <div class="col-md-6 text-end">
            <div class="social-links">
              <a href="#" class="text-muted me-3"
                ><i class="fab fa-github"></i
              ></a>
              <a href="#" class="text-muted me-3"
                ><i class="fab fa-linkedin"></i
              ></a>
              <a href="https://todoist.com" target="_blank" class="text-muted">
                <i class="fas fa-external-link-alt"></i> Inspiração: Todoist
              </a>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Offline Indicator -->
    <div
      id="offline-indicator"
      class="alert alert-warning position-fixed d-none"
      style="bottom: 20px; left: 20px; z-index: 9999"
    >
      <i class="fas fa-wifi-slash me-2"></i>
      Você está offline. Os dados serão sincronizados quando a conexão for
      restaurada.
    </div>

    <!-- JavaScript Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>

    <!-- Web Components -->
    <script type="module" src="components/task-item.js"></script>
    <script type="module" src="components/project-card.js"></script>

    <!-- Custom JavaScript -->
    <script src="assets/js/app.js"></script>

    <!-- Page-specific JavaScript -->
    <script>
      // Dashboard-specific functionality
      document.addEventListener("DOMContentLoaded", function () {
        // Update dashboard stats
        updateDashboardStats();

        // Load recent activity
        loadRecentActivity();

        // Setup quick task form
        setupQuickTaskForm();

        // Update progress bar
        updateProgressBar();

        // Setup Web Component event listeners
        setupWebComponentListeners();
      });

      function setupWebComponentListeners() {
        // Listen for task events from Web Components
        document.addEventListener("task-toggle", async (e) => {
          const { taskId, newStatus, completedAt } = e.detail;
          const task = appState.tasks.find((t) => t.id === taskId);
          if (task) {
            await taskManager.updateTask(taskId, {
              ...task,
              status: newStatus,
              completedAt: completedAt,
            });
            updateDashboardStats();
            updateProgressBar();
          }
        });

        document.addEventListener("task-edit", (e) => {
          const { taskId } = e.detail;
          taskManager.editTask(taskId);
        });

        document.addEventListener("task-delete", async (e) => {
          const { taskId } = e.detail;
          if (confirm("Tem certeza que deseja excluir esta tarefa?")) {
            await taskManager.deleteTask(taskId);
            updateDashboardStats();
            updateProgressBar();
          }
        });

        // Listen for project events
        document.addEventListener("project-view-tasks", (e) => {
          const { projectId } = e.detail;
          window.location.href = `pages/tasks.html?project=${projectId}`;
        });

        document.addEventListener("project-add-task", (e) => {
          const { projectId } = e.detail;
          localStorage.setItem("selectedProjectId", projectId);
          window.location.href = "pages/tasks.html#new-task";
        });
      }

      async function updateDashboardStats() {
        try {
          const tasks = appState.tasks || [];
          const completedTasks = tasks.filter(
            (task) => task.status === "completed",
          );
          const pendingTasks = tasks.filter(
            (task) => task.status === "pending",
          );

          document.getElementById("total-tasks").textContent = tasks.length;
          document.getElementById("completed-tasks").textContent =
            completedTasks.length;
          document.getElementById("pending-tasks").textContent =
            pendingTasks.length;

          // Calculate productivity score
          const productivityScore =
            tasks.length > 0
              ? Math.round((completedTasks.length / tasks.length) * 100)
              : 0;
          document.getElementById("productivity-score").textContent =
            productivityScore + "%";

          // Update weekly and monthly stats
          const now = new Date();
          const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
          const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);

          const weekCompleted = completedTasks.filter(
            (task) => task.completedAt && new Date(task.completedAt) >= weekAgo,
          ).length;

          const monthCompleted = completedTasks.filter(
            (task) =>
              task.completedAt && new Date(task.completedAt) >= monthAgo,
          ).length;

          document.getElementById("week-completed").textContent = weekCompleted;
          document.getElementById("month-completed").textContent =
            monthCompleted;
        } catch (error) {
          console.error("Error updating dashboard stats:", error);
        }
      }

      function loadRecentActivity() {
        const container = document.getElementById("recent-activity");
        const tasks = appState.tasks || [];

        // Get recently completed or modified tasks
        const recentTasks = tasks
          .filter((task) => task.completedAt || task.createdAt)
          .sort((a, b) => {
            const dateA = new Date(task.completedAt || task.createdAt);
            const dateB = new Date(task.completedAt || task.createdAt);
            return dateB - dateA;
          })
          .slice(0, 3);

        if (recentTasks.length === 0) {
          container.innerHTML =
            '<p class="text-muted text-center">Nenhuma atividade recente</p>';
          return;
        }

        container.innerHTML = recentTasks
          .map((task) => {
            const isCompleted = task.status === "completed";
            const actionDate = isCompleted ? task.completedAt : task.createdAt;
            const actionText = isCompleted ? "Concluída" : "Criada";

            return `
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <div class="d-flex align-items-center">
                            <i class="fas ${isCompleted ? "fa-check-circle text-success" : "fa-plus-circle text-primary"} me-2"></i>
                            <span class="fw-medium">${task.title}</span>
                        </div>
                        <small class="text-muted">${actionText}</small>
                    </div>
                `;
          })
          .join("");
      }

      function setupQuickTaskForm() {
        const form = document.getElementById("quick-task-form");
        if (form) {
          form.addEventListener("submit", async (e) => {
            e.preventDefault();

            const formData = new FormData(form);
            const title = formData.get("title").trim();

            if (title) {
              try {
                // Parse quick task with natural language processing
                const taskData = parseQuickTask(title);

                await taskManager.createTask(taskData);

                form.reset();
                updateDashboardStats();
                updateProgressBar();
                renderTodayTasks();
              } catch (error) {
                console.error("Error creating quick task:", error);
              }
            }
          });
        }
      }

      function parseQuickTask(title) {
        // Basic natural language processing for quick tasks
        let taskData = {
          title: title,
          description: "",
          priority: "medium",
          projectId: null,
          dueDate: null,
          tags: [],
        };

        // Extract tags (#tag)
        const tagMatches = title.match(/#(\w+)/g);
        if (tagMatches) {
          taskData.tags = tagMatches.map((tag) => tag.substring(1));
          taskData.title = title.replace(/#\w+/g, "").trim();
        }

        // Extract priority indicators
        if (title.includes("!!") || title.toLowerCase().includes("urgente")) {
          taskData.priority = "high";
        } else if (title.includes("!")) {
          taskData.priority = "medium";
        }

        // Extract time indicators
        const timePattern = /às?\s(\d{1,2}):?(\d{2})?h?/i;
        const timeMatch = title.match(timePattern);
        if (timeMatch) {
          const today = new Date();
          today.setHours(
            parseInt(timeMatch[1]),
            parseInt(timeMatch[2] || "0"),
            0,
            0,
          );
          taskData.dueDate = today.toISOString().split("T")[0];
        }

        return taskData;
      }

      function updateProgressBar() {
        const tasks = appState.tasks || [];
        const todayTasks = tasks.filter((task) => {
          if (!task.dueDate) return false;
          const today = new Date().toDateString();
          const taskDate = new Date(task.dueDate).toDateString();
          return today === taskDate;
        });

        const completedToday = todayTasks.filter(
          (task) => task.status === "completed",
        );
        const progress =
          todayTasks.length > 0
            ? (completedToday.length / todayTasks.length) * 100
            : 0;

        const progressBar = document.getElementById("daily-progress");
        const progressText = document.getElementById("progress-text");

        if (progressBar) {
          progressBar.style.width = progress + "%";
        }

        if (progressText) {
          progressText.textContent = `${completedToday.length} de ${todayTasks.length}`;
        }
      }

      function renderTodayTasks() {
        const container = document.getElementById("tasks-container");
        const tasks = appState.tasks || [];

        // Filter today's tasks
        const todayTasks = tasks.filter((task) => {
          if (!task.dueDate) return false;
          const today = new Date().toDateString();
          const taskDate = new Date(task.dueDate).toDateString();
          return today === taskDate;
        });

        if (todayTasks.length === 0) {
          container.innerHTML = `
                    <div class="text-center py-5">
                        <i class="fas fa-calendar-check" style="font-size: 4rem; color: var(--border-color);"></i>
                        <h3 class="text-muted mt-3">Nenhuma tarefa para hoje</h3>
                        <p class="text-muted">Que tal criar uma nova tarefa?</p>
                        <button class="btn btn-primary-custom" data-bs-toggle="modal" data-bs-target="#newTaskModal">
                            <i class="fas fa-plus me-2"></i>
                            Criar Tarefa
                        </button>
                    </div>
                `;
          return;
        }

        // Render tasks using Web Components
        container.innerHTML = todayTasks
          .map((task) => {
            const project = appState.projects.find(
              (p) => p.id === task.projectId,
            );
            return `
                    <task-item
                        .task='${JSON.stringify(task)}'
                        .project='${JSON.stringify(project)}'
                        editable="true">
                    </task-item>
                `;
          })
          .join("");
      }

      // Override taskManager.renderTasks to use Web Components
      if (window.TaskFlow && window.TaskFlow.taskManager) {
        const originalRenderTasks = window.TaskFlow.taskManager.renderTasks;
        window.TaskFlow.taskManager.renderTasks = function () {
          renderTodayTasks();
        };
      }
    </script>
  </body>
</html>
